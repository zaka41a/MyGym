<!DOCTYPE html>
<html lang="en">
<head>
  <title>Create an Account</title> <!-- FR: Titre de l’onglet navigateur -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- FR: Feuilles de style et bibliothèques externes -->
  <link rel="icon" type="image/png" href="images/icons/favicon.ico"/>
  <link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="fonts/Linearicons-Free-v1.0.0/icon-font.min.css">
  <link rel="stylesheet" href="vendor/animate/animate.css">
  <link rel="stylesheet" href="vendor/css-hamburgers/hamburgers.min.css">
  <link rel="stylesheet" href="vendor/animsition/css/animsition.min.css">
  <link rel="stylesheet" href="vendor/select2/select2.min.css">
  <link rel="stylesheet" href="vendor/daterangepicker/daterangepicker.css">
  <link rel="stylesheet" href="css/util.css">
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/custom.css"><!-- FR: CSS personnalisées -->
</head>
<body>
  <div class="limiter">
    <!-- FR: Conteneur avec image de fond -->
    <div class="container-login100" style="background-image: url('images/Gymbackground.jpg');">
      <div class="wrap-login100 p-t-30 p-b-50">
        <!-- FR: Titre principal du formulaire -->
        <span class="login100-form-title p-b-41">Create an Account</span>

        <!-- FR: Zone prévue pour afficher les erreurs -->
        <div id="errorBox" class="mb-3"></div>

        <!-- FR: Formulaire d’inscription -->
        <form action="/MyGym/backend/register.php" method="post" class="login100-form validate-form p-b-33 p-t-5">

          <!-- FR: Champ Nom complet -->
          <div class="wrap-input100 validate-input" data-validate="Full name required">
            <input class="input100" type="text" name="fullname" placeholder="Full name" required>
            <span class="focus-input100" data-placeholder="&#xe82a;"></span>
          </div>

          <!-- FR: Champ Email -->
          <div class="wrap-input100 validate-input" data-validate="Email required">
            <input class="input100" type="email" name="email" placeholder="Email" required>
            <span class="focus-input100" data-placeholder="&#xe818;"></span>
          </div>

          <!-- FR: Champ Nom d’utilisateur -->
          <div class="wrap-input100 validate-input" data-validate="Username required">
            <input class="input100" type="text" name="username" placeholder="Username" required>
            <span class="focus-input100" data-placeholder="&#xe82a;"></span>
          </div>

          <!-- FR: Champ Mot de passe -->
          <div class="wrap-input100 validate-input" data-validate="Password required">
            <input class="input100" type="password" id="pass" name="pass" placeholder="Password" required>
            <span class="focus-input100" data-placeholder="&#xe80f;"></span>
          </div>

          <!-- FR: Champ Confirmation du mot de passe -->
          <div class="wrap-input100 validate-input" data-validate="Confirmation required">
            <input class="input100" type="password" id="confirmpass" name="confirmpass" placeholder="Confirm password" required>
            <span class="focus-input100" data-placeholder="&#xe80f;"></span>
            <!-- FR: Message dynamique (mots de passe identiques ou non) -->
            <small id="pwMsg" class="d-block mt-2 text-center" style="min-height:1em; font-weight:bold;"></small>
          </div>

          <!-- FR: Bouton d’inscription désactivé tant que les mots de passe ne correspondent pas -->
          <div class="container-login100-form-btn m-t-32">
            <button type="submit" class="login100-form-btn" id="registerBtn" disabled>Sign up</button>
          </div>

          <!-- FR: Lien vers la connexion -->
          <div class="text-center p-t-20">
            <span style="color:#000;">Already have an account? </span>
            <a href="login.html" style="color:#ff4b5c; font-weight:bold;">Sign in</a>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- FR: Dépendances JS -->
  <script src="vendor/jquery/jquery-3.2.1.min.js"></script>
  <script src="vendor/animsition/js/animsition.min.js"></script>
  <script src="vendor/bootstrap/js/popper.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
  <script src="vendor/select2/select2.min.js"></script>
  <script src="vendor/daterangepicker/moment.min.js"></script>
  <script src="vendor/daterangepicker/daterangepicker.js"></script>
  <script src="vendor/countdowntime/countdowntime.js"></script>
  <script src="js/main.js"></script>

  <!-- FR: Affichage des erreurs renvoyées par PHP -->
  <script>
    (function () {
      const qs = new URLSearchParams(location.search);
      const e  = qs.get('error');
      const box = document.getElementById('errorBox');
      if (!e || !box) return;
      const M = {
        empty: '❌ All fields are required.',
        invalid_email: '❌ Invalid email.',
        nomatch: '❌ Passwords do not match.',
        shortpass: '❌ Password must be at least 6 characters long.',
        duplicate: '⚠️ Email or username already exists.',
        dberror: '⚠️ Internal error, please try again later.'
      };
      box.innerHTML = `<div class="alert alert-danger text-center">${M[e] || '⚠️ Email or username already exists.'}</div>`;
    })();
  </script>

  <!-- FR: Vérification en direct + activation/désactivation du bouton -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.querySelector('form.login100-form');
      const pass = document.getElementById('pass');
      const conf = document.getElementById('confirmpass');
      const btn  = document.getElementById('registerBtn');
      const msg  = document.getElementById('pwMsg');

      function updateState() {
        const filled = pass.value.length > 0 && conf.value.length > 0;
        if (filled && pass.value !== conf.value) {
          msg.textContent = '❌ Passwords do not match';
          msg.style.color = '#dc3545';
          btn.disabled = true;
          conf.setCustomValidity('Mismatch');
        } else if (filled) {
          msg.textContent = '✔ Passwords match';
          msg.style.color = '#198754';
          btn.disabled = false;
          conf.setCustomValidity('');
        } else {
          msg.textContent = '';
          btn.disabled = true;
          conf.setCustomValidity('');
        }
      }

      // FR: Vérification au moment de la soumission
      form.addEventListener('submit', (e) => {
        if (pass.value !== conf.value) {
          e.preventDefault();
          btn.disabled = true;
          conf.setCustomValidity('Mismatch');
          conf.reportValidity();
        }
      });

      // FR: Vérification en direct quand l’utilisateur tape
      pass.addEventListener('input', updateState);
      conf.addEventListener('input', updateState);
      updateState();
    });
  </script>
</body>
</html>
